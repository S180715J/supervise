<!DOCTYPE HTML>
<html>

<head>
	<meta charset="utf-8">
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<link rel="Bookmark" href="/favicon.ico">
	<link rel="Shortcut Icon" href="/favicon.ico" />

	<link rel="stylesheet" type="text/css" href="../static/h-ui/css/H-ui.min.css" />
	<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/css/H-ui.admin.css" />
	<link rel="stylesheet" type="text/css" href="../lib/Hui-iconfont/1.0.8/iconfont.css" />
	<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/skin/default/skin.css" id="skin" />
	<link rel="stylesheet" type="text/css" href="../static/h-ui.admin/css/style.css" />

	<title>事项信息</title>
</head>

<body>
	<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 事项信息 <span class="c-gray en">&gt;</span>
		事项信息列表 <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);"
			 title="刷新"><i class="Hui-iconfont">&#xe68f;</i></a></nav>
	<div class="page-container">

		<div class="text-c">
			<form>
				<table class="table  table-bg">
					<thead>

						<tr class="text-c">

							<th>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-5">事项<br />来源</label>
									<div class="formControls col-xs-8 col-sm-7">
										<span class="select-box">
												<select name="" class="select">
													<option value="1">未删除</option>
													<option value="2">已删除</option>
												</select>
											</span>
									</div>
								</div>
							</th>
							<th>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-5">事项<br />编号</label>
									<div class="formControls col-xs-8 col-sm-7">
										<input type="text" class="input-text" value="" placeholder="" id="username" name="username" />
										</div>
									</div>
							</th>
							<th>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-5">事项<br />名称</label>
									<div class="formControls col-xs-8 col-sm-7">
										<input type="text" class="input-text" value="" placeholder="" id="username" name="username" />
										</div>
									</div>
							</th>

							<th>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-5">事项<br />内容</label>
									<div class="formControls col-xs-8 col-sm-7">
										<input type="text" class="input-text" value="" placeholder="" id="username" name="username" />
										</div>
									</div>
							</th>
							<th>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-5">是否任务超时</label>
									<div class="formControls col-xs-8 col-sm-7">
										<span class="select-box">
												<select name="" class="select">
													<option value="1">未删除</option>
													<option value="2">已删除</option>
												</select>
											</span>
									</div>
								</div>
							</th>

						</tr>

						<tr class="text-c">
							<th>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-5">当前<br />状态</label>
									<div class="formControls col-xs-8 col-sm-7">
										<span class="select-box">
												<select name="" class="select">
													<option value="1">未删除</option>
													<option value="2">已删除</option>
												</select>
											</span>
									</div>
								</div>
							</th>
							<th>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-5">公司<br />领导</label>
									<div class="formControls col-xs-8 col-sm-7">
										<input type="text" class="input-text" value="" placeholder="" id="username" name="username" />
										</div>
									</div>
							</th>
							<th>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-5">牵头<br />部门</label>
									<div class="formControls col-xs-8 col-sm-7">
										<input type="text" class="input-text" value="" placeholder="" id="username" name="username" />
										</div>
									</div>
							</th>

							<th>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-5">是否<br />延期</label>
									<div class="formControls col-xs-8 col-sm-7">
										<span class="select-box">
												<select name="" class="select">
													<option value="1">未删除</option>
													<option value="2">已删除</option>
												</select>
											</span>
									</div>
								</div>
							</th>
							<th>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-5">是否<br />已订阅</label>
									<div class="formControls col-xs-8 col-sm-7">
										<span class="select-box">
												<select name="" class="select">
													<option value="1">未删除</option>
													<option value="2">已删除</option>
												</select>
											</span>
									</div>
								</div>
							</th>
						</tr>
						<tr>
							<th scope="col" colspan="2">
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-4">最后修改时间</label>
									<div class="formControls col-xs-8 col-sm-9">
										<input type="text" onfocus="WdatePicker({ maxDate:'#F{$dp.$D(\'datemax\')||\'%y-%M-%d\'}' })" id="datemin"
											 class="input-text Wdate" style="width:120px;">
											-
										<input type="text" onfocus="WdatePicker({ minDate:'#F{$dp.$D(\'datemin\')}',maxDate:'%y-%M-%d' })" id="datemax"
											 class="input-text Wdate" style="width:120px;">
										</div>
									</div>
							</th>
							<th scope="col" colspan="2">
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-4">最后修改时间</label>
									<div class="formControls col-xs-8 col-sm-9">
										<input type="text" onfocus="WdatePicker({ maxDate:'#F{$dp.$D(\'datemax\')||\'%y-%M-%d\'}' })" id="datemin"
											 class="input-text Wdate" style="width:120px;">
											-
										<input type="text" onfocus="WdatePicker({ minDate:'#F{$dp.$D(\'datemin\')}',maxDate:'%y-%M-%d' })" id="datemax"
											 class="input-text Wdate" style="width:120px;">
										</div>
									</div>
							</th>
							<th>
								<div class="row cl">

									<div class="col-xs-9 col-sm-9 col-xs-offset-4 col-sm-offset-1">
										<input class="btn btn-primary radius" type="submit" value="&nbsp;&nbsp;检索&nbsp;&nbsp;" />
										<input class="btn btn-primary radius" type="submit" value="&nbsp;&nbsp;重置&nbsp;&nbsp;" />
										</div>
									</div>
							</th>
						</tr>
					</thead>
				</table>
			</form>
		</div>
		<div class="cl pd-5 bg-1 bk-gray mt-20">
			<span class="l">
					<a href="javascript:;" onclick="datadel()" class="btn btn-danger radius"><i class="Hui-iconfont"></i> 导出XLS</a>
					<a href="javascript:;" onclick="admin_add('合并','entering-item.html','1000','500')" class="btn btn-primary radius"><i
						 class="Hui-iconfont">&#xe600;</i>合并</a>
					<a href="javascript:;" onclick="admin_add('取消合并','entering-item.html','1000','500')" class="btn btn-primary radius"><i
						 class="Hui-iconfont">&#xe600;</i>取消合并</a>

				</span>
		</div>
		<table class="table table-border table-bordered table-bg">
			<thead>
				<tr>
					<th scope="col" colspan="10"><span class="r">共有数据：<strong>54</strong>条</span></th>
				</tr>
				<tr class="text-c">
					<th width="40"><input type="checkbox" name="" value="">全选</th>
					<th width="140">事项名称</th>
					<th width="50">公司领导</th>
					<th width="50">牵头部门</th>
					<th width="50">负责人</th>
					<th width="150">应办时间</th>
					<th width="150">最后修改的时间</th>
					<th width="100">操作</th>

				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>
	<!--_footer 作为公共模版分离出去-->
	<script type="text/javascript" src="../lib/jquery/1.9.1/jquery.min.js"></script>
	<script type="text/javascript" src="../lib/layer/2.4/layer.js"></script>
	<script type="text/javascript" src="../static/h-ui/js/H-ui.min.js"></script>
	<script type="text/javascript" src="../static/h-ui.admin/js/H-ui.admin.js"></script>
	<!--/_footer 作为公共模版分离出去-->

	<!--请在下方写此页面业务相关的脚本-->
	<script type="text/javascript" src="../lib/My97DatePicker/4.8/WdatePicker.js"></script>
	<script type="text/javascript" src="../lib/datatables/1.10.0/jquery.dataTables.min.js"></script>
	<script type="text/javascript" src="../lib/laypage/1.2/laypage.js"></script>
	<script type="text/javascript" src="../js/common.js"></script>
	<script type="text/javascript">
		/*
	参数解释：
	title	标题
	url		请求的url
	id		需要操作的数据id
	w		弹出层宽度（缺省调默认值）
	h		弹出层高度（缺省调默认值）
*/
		/*管理员-增加*/
		function admin_add(title, url, w, h) {
			layer_show(title, url, w, h);
		}
		/*管理员-删除*/
		function admin_del(obj, id) {
			layer.confirm('确认要取消订阅吗？', function(index) {
				$.ajax({
					type: 'POST',
					url: '',
					dataType: 'json',
					success: function(data) {
						$(obj).parents("tr").remove();
						layer.msg('已取消订阅!', {
							icon: 1,
							time: 1000
						});
					},
					error: function(data) {
						console.log(data.msg);
					},
				});
			});
		}

		/*管理员-编辑*/
		function admin_edit(title, url, id, w, h) {
			layer_show(title, url, w, h);
		}
		/*管理员-停用*/
		function admin_stop(obj, id) {
			layer.confirm('确认要删除吗？', function(index) {
				//此处请求后台程序，下方是成功后的前台处理……

				$(obj).parents("tr").find(".td-manage").prepend(
					'<a onClick="admin_start(this,id)" href="javascript:;" title="恢复" style="text-decoration:none"><i class="Hui-iconfont">&#xe615;</i></a>'
				);
				$(obj).parents("tr").find(".td-status").html('<span class="label label-default radius">已删除</span>');
				$(obj).remove();
				layer.msg('已删除!', {
					icon: 5,
					time: 1000
				});
			});
		}

		/*管理员-启用*/
		function admin_start(obj, id) {
			layer.confirm('确认要恢复吗？', function(index) {
				//此处请求后台程序，下方是成功后的前台处理……


				$(obj).parents("tr").find(".td-manage").prepend(
					'<a onClick="admin_stop(this,id)" href="javascript:;" title="停用" style="text-decoration:none"><i class="Hui-iconfont">&#xe631;</i></a>'
				);
				$(obj).parents("tr").find(".td-status").html('<span class="label label-success radius">已恢复</span>');
				$(obj).remove();
				layer.msg('已恢复!', {
					icon: 6,
					time: 1000
				});
			});
		}
	</script>

	<script type="text/javascript">
		$(function() {
			$.ajax({
				url: HOST_URL + "item/list",
				type: "GET",
				dataType: "json",
				success: function(data) {
					if (data == 0) {
						var $p = "<p>没有数据</p>";
						$("tbody").append($p);
					}
					else {
						var int;
						$.each(data, function(i, v) {
							//调用each的方法，遍历数据，返回数据的个数
							int = each(i, v);
						});
						$("strong").html(int + 1);
					}
				},
				xhrFields: {
					withCredentials: true
				}
			});
			//得到操作人
			function getUser(itemCode, index) {
				$.ajax({
					url: HOST_URL + "main/item_list/" + itemCode,
					type: "GET",
					dataType: "json",
					success: function(data) {
						if (data != 0) {
							$.each(data, function(i, v) {
								$("tbody tr:eq(" + index + ") td:eq(" + (2 + i) + ")").html(v.userId.realName);
							})
						}
						else {
							$("tbody tr:eq(" + index + ") td:eq(2)").html("null");
							$("tbody tr:eq(" + index + ") td:eq(3)").html("null");
							$("tbody tr:eq(" + index + ") td:eq(4)").html("null");
						}
					},
					xhrFields: {
						withCredentials: true
					}
				});
			}
			/**
			 * 对后台返回数据的each方法
			 */
			function each(i, v) {
				var $tr = "<tr>" +
					"<td><input type='checkbox' value='" + (i + 1) + "' name=''></td>" +
					"<td>" + v.itemName + "</td>" +
					"<td></td>" +
					"<td></td>" +
					"<td></td>" +
					"<td>" + v.overTime + "</td>" +
					"<td>" + v.itemCode.optTime + "</td>" +
					"<td>操作</td>" +
					"</tr>";
				$("tbody").append($tr);
				/**
				 * 对操作时间与事项对应的同步操作
				 */
				getUser(v.itemCode.itemCode, i);
				//返回循环次数得到数据总数
				return i;
			}

		});
	</script>
</body>

</html>
